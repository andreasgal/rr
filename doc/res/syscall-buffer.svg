<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="486px" height="263px" version="1.1"><defs/><g transform="translate(0.5,0.5)"><path d="M 1 21 L 1 1 L 483 1 L 483 21 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 1 21 L 1 261 L 483 261 L 483 21" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px"><text x="242" y="15">ptrace traps vs. syscall buffering</text></g><path d="M 21 21 L 1 21 L 1 145 L 21 145 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 21 L 483 21 L 483 145 L 21 145" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" transform="rotate(-90,11,83)"><text x="11" y="87">ptrace traps</text></g><rect x="22" y="21" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="62" y="45">syscall</text></g><rect x="181" y="21" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="221" y="45">syscall</text></g><rect x="61" y="101" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="101" y="125">rr</text></g><path d="M 62 61 Q 62 61 87 96" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 91 100 L 84 96 L 87 96 L 89 92 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="39" y="65" width="38" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="58" y="89">trap</text></g><path d="M 153 61 Q 153 61 176 95" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 178 100 L 172 96 L 176 95 L 178 92 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 192 101 Q 192 101 209 66" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 212 62 L 212 69 L 209 66 L 205 66 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="152" y="101" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="192" y="125">rr</text></g><rect x="130" y="65" width="38" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="149" y="89">trap</text></g><path d="M 233 61 Q 233 61 256 95" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 258 100 L 252 96 L 256 95 L 258 92 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 272 101 Q 272 101 289 66" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 292 62 L 292 69 L 289 66 L 285 66 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="232" y="101" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="272" y="125">rr</text></g><rect x="210" y="65" width="38" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="229" y="89">trap</text></g><path d="M 313 61 Q 313 61 336 95" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 338 100 L 332 96 L 336 95 L 338 92 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 352 101 Q 352 101 369 66" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 372 62 L 372 69 L 369 66 L 365 66 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="312" y="101" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="352" y="125">rr</text></g><rect x="290" y="65" width="38" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="309" y="89">trap</text></g><path d="M 393 65 Q 393 65 416 99" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 418 104 L 412 100 L 416 99 L 418 96 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 432 105 Q 432 105 449 70" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 452 66 L 452 73 L 449 70 L 445 70 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="392" y="105" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="432" y="129">rr</text></g><rect x="370" y="69" width="38" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="389" y="93">trap</text></g><path d="M 21 145 L 1 145 L 1 261 L 21 261 Z" fill="#ffffff" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 21 145 L 483 145 L 483 261 L 21 261" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><g fill="#000000" font-family="Helvetica" font-weight="bold" text-anchor="middle" font-size="12px" transform="rotate(-90,11,203)"><text x="11" y="207">syscall buffering</text></g><rect x="22" y="145" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="62" y="169">syscall</text></g><rect x="101" y="145" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="141" y="169">syscall</text></g><rect x="181" y="145" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="221" y="169">syscall</text></g><rect x="261" y="145" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="301" y="169">syscall</text></g><rect x="341" y="145" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="381" y="169">syscall</text></g><path d="M 89 185 Q 89 185 122 185" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 127 185 L 120 188 L 122 185 L 120 181 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="62" y="169" width="80" height="18" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="102" y="182">buffer</text></g><rect x="381" y="185" width="38" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="400" y="209">flush</text></g><path d="M 404 181 Q 404 181 427 215" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 429 220 L 423 216 L 427 215 L 429 212 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 443 221 Q 443 221 460 186" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 463 182 L 463 189 L 460 186 L 456 186 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="403" y="221" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="443" y="245">rr</text></g><path d="M 168 186 Q 168 186 201 186" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 206 186 L 199 189 L 201 186 L 199 182 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="141" y="170" width="80" height="18" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="181" y="183">buffer</text></g><path d="M 246 186 Q 246 186 279 186" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 284 186 L 277 189 L 279 186 L 277 182 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="219" y="170" width="80" height="18" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="259" y="183">buffer</text></g><path d="M 328 187 Q 328 187 361 187" fill="none" stroke="#000000" stroke-miterlimit="10" stroke-dasharray="3 3" pointer-events="none"/><path d="M 366 187 L 359 190 L 361 187 L 359 183 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><rect x="301" y="171" width="80" height="18" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="341" y="184">buffer</text></g><rect x="101" y="21" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="141" y="45">syscall</text></g><rect x="261" y="21" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="301" y="45">syscall</text></g><rect x="341" y="21" width="80" height="40" fill="none" stroke="none" pointer-events="none"/><g fill="#000000" font-family="Helvetica" text-anchor="middle" font-size="12px"><text x="381" y="45">syscall</text></g><path d="M 101 101 Q 101 101 118 66" fill="none" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/><path d="M 121 62 L 121 69 L 118 66 L 114 66 Z" fill="#000000" stroke="#000000" stroke-miterlimit="10" pointer-events="none"/></g></svg>